DROP TABLE MEMBERS;
DROP TABLE FISHES;
DROP TABLE MEMBERFISH;
DROP TABLE RESERVATION;
DROP TABLE PRODUCTS;
DROP TABLE FOLLOWERS;
DROP TABLE ARTICLES;
DROP TABLE COMMENTS;
DROP TABLE TAGS;
DROP TABLE POSTTAG;
DROP TABLE VISITOR;
DROP VIEW RESSEARCH;
CREATE TABLE MEMBERS
(
MID       VARCHAR(50) PRIMARY KEY,
PASSWORD  VARCHAR(50)     NULL,
NAME      VARCHAR(50)     NULL,
BIRTH     VARCHAR(100)    NULL,
MAIL      VARCHAR(100)    NULL,
PHONE     VARCHAR(80)     NULL,
PROFILEPHOTO VARCHAR(100) NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE FISHES
(
FISHSEQ   INT AUTO_INCREMENT PRIMARY KEY,
FISHNAME  VARCHAR(100)    NOT NULL,
KIND      VARCHAR(100)    NOT NULL,
HABITAT   VARCHAR(100)    NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE MEMBERFISH
(
MFISHSEQ    INT         AUTO_INCREMENT PRIMARY KEY,
LEN       VARCHAR(50) NULL,
WEI       VARCHAR(50) NULL,
DATE      VARCHAR(50) NULL,
MID       VARCHAR(50) NOT NULL,
FISHSEQ   INT         NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*
ALTER TABLE Memberfish
ADD CONSTRAINT FK_Memberfish_mid_Member_mid FOREIGN KEY (mid)
REFERENCES Member (mid) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE Memberfish
ADD CONSTRAINT FK_Memberfish_fishseq_Fish_fishseq FOREIGN KEY (fishseq)
REFERENCES Fish (fishseq) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE TABLE RESERVATION
(
RESNUM   INT AUTO_INCREMENT PRIMARY KEY,
MID       VARCHAR(50)    NULL,
RESNAME   VARCHAR(50)    NULL,
STARTDATE VARCHAR(50)     NULL,
AMPM      VARCHAR(100)     NULL,
PHONE     VARCHAR(50)    NULL,
RESDATE       VARCHAR(50)  NULL,
RESCOUNT  VARCHAR(50)     NULL,
DEPOSIT   VARCHAR(70)     NULL,
MESSAGE   VARCHAR(200)    NULL,
PRONAME   VARCHAR(50)     NULL,
COMPANY     VARCHAR(100)  NULL,
PRONUM   INT            NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE PRODUCTS
(
PRONUM    INT AUTO_INCREMENT PRIMARY KEY,
PRONAME  VARCHAR(100)    NOT NULL,
PRICE     VARCHAR(100)    NOT NULL,
COMPANY   VARCHAR(100)    NOT NULL,
ADDRESS   VARCHAR(100)    NOT NULL,
CATEGORY  VARCHAR(40)     NOT NULL,
PROIMG    VARCHAR(45)     NOT NULL,
REGIDATE  VARCHAR(70)     NOT NULL,
FISHNAME  VARCHAR(70)     NULL,
PHONE  VARCHAR(70)        NULL,
LAT  VARCHAR(70)          NULL,
LNG  VARCHAR(70)          NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*
ALTER TABLE Reservation
ADD CONSTRAINT FK_Reservation_mid_Member_mid FOREIGN KEY (mid)
REFERENCES Member (mid) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE TABLE FOLLOWERS
(
FOLLOSEQ  INT AUTO_INCREMENT PRIMARY KEY,
FOLLOID   VARCHAR(100)    NOT NULL,
MID       VARCHAR(100)    NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*
ALTER TABLE Follower
ADD CONSTRAINT FK_Follower_mid_Member_mid FOREIGN KEY (mid)
REFERENCES Member (mid) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE TABLE ARTICLES
(
ARTNUM    INT AUTO_INCREMENT PRIMARY KEY,
CONTENT   VARCHAR(300)    NULL,
ARTDATE   VARCHAR(80)     NULL,
ARTPHOTO  VARCHAR(100)    NULL,
EXTENSION VARCHAR(50)     NULL,
MID       VARCHAR(50)     NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*
ALTER TABLE Article
ADD CONSTRAINT FK_Article_mid_Member_mid FOREIGN KEY (mid)
REFERENCES Member (mid) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE TABLE COMMENTS
(
COMMSEQ   INT AUTO_INCREMENT PRIMARY KEY,
TITLESEQ  INT NOT NULL,
COMM      VARCHAR(100) NOT NULL,
COMID    VARCHAR(50) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
/*
ALTER TABLE Comment
ADD CONSTRAINT FK_Comment_titleseq_Article_artnum FOREIGN KEY (titleseq)
REFERENCES Article (artnum) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE TABLE TAGS
(
TAGNAME  VARCHAR(70) NOT NULL PRIMARY KEY
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE POSTTAG
(
PTSEQ    INT AUTO_INCREMENT PRIMARY KEY,
ARTSEQ   INT NOT NULL,
TAGNAME  VARCHAR(70) NOT NULL
)ENGINE=InnoDB DEFAULT CHARSET=utf8;
CREATE TABLE VISITOR
(
VISITSEQ   INT AUTO_INCREMENT PRIMARY KEY,
VISITID  VARCHAR(100)    NOT NULL,
VISITTIME      VARCHAR(100)    NOT NULL)ENGINE=InnoDB DEFAULT  CHARSET=utf8;
/*
ALTER TABLE Posttag
ADD CONSTRAINT FK_Posttag_artseq_Article_artnum FOREIGN KEY (artseq)
REFERENCES Article (artnum) ON DELETE RESTRICT ON UPDATE RESTRICT;
ALTER TABLE Posttag
ADD CONSTRAINT FK_Posttag_tagname_Tag_tagbane FOREIGN KEY (tagname)
REFERENCES Tag (tagbane) ON DELETE RESTRICT ON UPDATE RESTRICT;
*/
CREATE VIEW RESSEARCH AS
SELECT A.*
FROM (SELECT   R.RESNUM,R.MID,R.RESNAME,P.COMPANY,P.PRONAME,R.STARTDATE,R.AMPM,R.PHONE,R.RESDATE,R.DEPOSIT,P.CATEGORY,R.RESCOUNT,P.PROIMG
FROM RESERVATION R JOIN PRODUCTS P ON
R.PRONUM = P.PRONUM
ORDER BY RESNUM DESC) A ;